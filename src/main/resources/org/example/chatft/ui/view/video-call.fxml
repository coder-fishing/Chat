<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>

<BorderPane prefHeight="600" prefWidth="800" style="-fx-background-color: #1a1a1a;" stylesheets="@style/video-call.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.chatft.ui.controller.VideoCallController">

    <!-- Center: Video Display -->
    <center>
        <StackPane fx:id="videoContainer">
            <!-- Remote Video (Full Screen) -->
            <ImageView fx:id="remoteVideoView" preserveRatio="false" style="-fx-effect: dropshadow(gaussian, rgba(0,0,0,0.5), 10, 0, 0, 0);">
                <fitWidth><StackPane fx:constant="USE_COMPUTED_SIZE" /></fitWidth>
                <fitHeight><StackPane fx:constant="USE_COMPUTED_SIZE" /></fitHeight>
            </ImageView>

            <!-- Local Video (Picture-in-Picture) -->
            <StackPane alignment="TOP_RIGHT" style="-fx-padding: 20;" StackPane.alignment="TOP_RIGHT">
                <ImageView fx:id="localVideoView" fitHeight="150" fitWidth="200" preserveRatio="true" style="-fx-background-color: #2a2a2a; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.7), 15, 0, 0, 5);" />
            </StackPane>

            <!-- Status Overlay (Top Center) -->
            <VBox alignment="TOP_CENTER" spacing="10" style="-fx-padding: 30;" StackPane.alignment="TOP_CENTER">
                <Label fx:id="remoteUserLabel" style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, black, 10, 0.5, 0, 2);" text="Connecting..." />
                <Label fx:id="statusLabel" style="-fx-text-fill: #b3b3b3; -fx-font-size: 14px; -fx-effect: dropshadow(gaussian, black, 5, 0.5, 0, 1);" text="Initializing..." />
            </VBox>
        </StackPane>
    </center>

    <!-- Bottom: Controls -->
    <bottom>
        <HBox alignment="CENTER" spacing="20" style="-fx-background-color: rgba(26, 26, 26, 0.9); -fx-padding: 20; -fx-background-radius: 15 15 0 0;">

            <!-- Mute Button -->
            <Button fx:id="muteButton" onAction="#handleMute" styleClass="control-btn" text="ðŸ”Š">
                <tooltip>
                    <Tooltip text="Mute/Unmute microphone" />
                </tooltip>
            </Button>

            <!-- Camera Toggle -->
            <Button fx:id="cameraButton" onAction="#handleCamera" styleClass="control-btn" text="ðŸ“·">
                <tooltip>
                    <Tooltip text="Turn camera on/off" />
                </tooltip>
            </Button>

            <!-- End Call Button -->
            <Button fx:id="endCallButton" onAction="#handleEndCall" styleClass="control-btn, end-call-btn" text="ðŸ“ž">
                <tooltip>
                    <Tooltip text="End call" />
                </tooltip>
            </Button>

        </HBox>
    </bottom>

</BorderPane>
