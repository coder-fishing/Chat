<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>

<BorderPane prefHeight="700" prefWidth="1000" stylesheets="@style/main.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.chatft.ui.controller.MainController">

    <!-- Left Sidebar -->
    <left>
        <VBox prefWidth="280" styleClass="sidebar, border-right">

            <!-- Sidebar Header -->
            <HBox alignment="CENTER_LEFT" spacing="10" styleClass="sidebar-header">
                <Label styleClass="sidebar-title" text="Chats" />
                <Region HBox.hgrow="ALWAYS" />
<!--                <Button fx:id="addIpButton" styleClass="settings-btn" text="+" onAction="#handleAddDirectIp" />-->
                <Button styleClass="settings-btn" text="âš™" />
            </HBox>

            <!-- Search Box -->
            <HBox style="-fx-padding: 0 15 10 15;">
                <TextField fx:id="searchField" prefHeight="36" promptText="ðŸ” Search Messenger" styleClass="search-field" HBox.hgrow="ALWAYS" />
            </HBox>

            <!-- Tabs for Users/Groups -->
            <TabPane fx:id="leftTabPane" styleClass="tab-pane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">

                <!-- Users Tab -->
                <Tab styleClass="tab" text="Messages">
                    <VBox spacing="0" styleClass="bg-white">
                        <ListView fx:id="userListView" prefHeight="567.0" prefWidth="248.0" styleClass="list-view" VBox.vgrow="ALWAYS" />
                    </VBox>
                </Tab>

                <!-- Groups Tab -->
                <Tab styleClass="tab" text="Groups">
                    <VBox spacing="8" style="-fx-background-color: #ffffff; -fx-padding: 15;">

                        <Button fx:id="createPublicGroupBtn" onAction="#handleCreatePublicGroup" prefHeight="36" prefWidth="240" styleClass="btn-secondary">
                            <graphic>
                                <HBox alignment="CENTER" spacing="6">
                                    <ImageView fitHeight="18" fitWidth="18" preserveRatio="true">
                                        <image>
                                            <Image url="@icons/add.png" />
                                        </image>
                                    </ImageView>
                                    <Label text="Create Public Group" />
                                </HBox>
                            </graphic>
                        </Button>

                        <Button fx:id="createPrivateGroupBtn" onAction="#handleCreatePrivateGroup" prefHeight="36" prefWidth="240" styleClass="btn-secondary">
                            <graphic>
                                <HBox alignment="CENTER" spacing="6">
                                    <ImageView fitHeight="18" fitWidth="18" preserveRatio="true">
                                        <image>
                                            <Image url="@icons/lock.png" />
                                        </image>
                                    </ImageView>
                                    <Label text="Create Private Group" />
                                </HBox>
                            </graphic>
                        </Button>

                        <Separator styleClass="separator" />

                        <!-- Sub-tabs for Public and Private Groups -->
                        <TabPane fx:id="groupTabPane" tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
                            
                            <!-- Public Groups Tab -->
                            <Tab text="Public Groups">
                                <ListView fx:id="publicGroupListView" styleClass="list-view" VBox.vgrow="ALWAYS" />
                            </Tab>

                            <!-- Private Groups Tab -->
                            <Tab text="Private Groups">
                                <ListView fx:id="privateGroupListView" styleClass="list-view" VBox.vgrow="ALWAYS" />
                            </Tab>

                        </TabPane>
                    </VBox>
                </Tab>

            </TabPane>
        </VBox>
    </left>

    <!-- Center Chat Area -->
    <center>
        <BorderPane fx:id="chatPane" styleClass="bg-white">

            <!-- Chat Header -->
            <top>
                <HBox alignment="CENTER_LEFT" spacing="12" styleClass="chat-header, border-bottom, font-emoji">

                    <Label style="-fx-font-size: 20px;" text="ðŸ‘¤" />

                    <VBox spacing="2">
                        <Label fx:id="chatHeaderLabel" styleClass="chat-header-title" text="Select a conversation" />
                        <Label styleClass="chat-header-status" text="Active now" />
                    </VBox>

                    <Region HBox.hgrow="ALWAYS" />

                    <Button styleClass="btn-icon" text="ðŸ“ž" />
                    <Button fx:id="videoCallButton" onAction="#handleVideoCall" styleClass="btn-icon" text="ðŸ“¹" />
                    <Button styleClass="btn-icon" text="â„¹" />
                </HBox>
            </top>

            <!-- Messages Area -->
            <center>
                <ScrollPane fx:id="chatScrollPane" fitToWidth="true" styleClass="scroll-pane" vbarPolicy="AS_NEEDED">
                    <VBox fx:id="messagesBox" spacing="8">
                        <padding>
                            <Insets bottom="20" left="20" right="20" top="20" />
                        </padding>
                  <styleClass>
                     <String fx:value="messages-container" />
                     <String fx:value="file-icon" />
                     <String fx:value="font-emoji" />
                  </styleClass>
                    </VBox>
                </ScrollPane>
            </center>

            <!-- Input Area -->
            <bottom>
                <HBox alignment="CENTER" prefHeight="18.0" prefWidth="205.0" spacing="8" styleClass="input-container, border-top, font-emoji">

<!--                    <Button fx:id="addButton" prefHeight="32.0" prefWidth="55.0" styleClass="btn-icon" text="+" />-->

                    <Button fx:id="fileButton" onAction="#handleSendFile" styleClass="btn-icon">
                        <graphic>
                            <ImageView fitHeight="22" fitWidth="22" preserveRatio="true">
                                <image>
                                    <Image url="@icons/camera.png" />
                                </image>
                            </ImageView>
                        </graphic>
                    </Button>

                    <HBox fx:id="textFieldContainer" alignment="CENTER" prefHeight="40.0" prefWidth="565.0" spacing="10" styleClass="input-field-wrapper" HBox.hgrow="ALWAYS">
                        <!-- âœ… Äá»”I TextField â†’ TextArea -->
                        <TextArea fx:id="messageInput" minHeight="27.0" prefHeight="48.0" prefRowCount="1" prefWidth="470.0" promptText="Aa" styleClass="input-field" wrapText="true" HBox.hgrow="ALWAYS" />

<!--                        <Button fx:id="emojiButton" prefHeight="37.0" prefWidth="112.0" style="-fx-font-size: 18px;" styleClass="btn-icon" text="cc" />-->

                        <Button fx:id="sendLikeButton" onAction="#handleSendLikeButton" styleClass="btn-icon">
                            <graphic>
                                <ImageView fitHeight="22" fitWidth="22" preserveRatio="true">
                                    <image>
                                        <Image url="@icons/like.png" />
                                    </image>
                                </ImageView>
                            </graphic>
                        </Button>
                    </HBox>

                    <Button fx:id="sendButton" onAction="#handleSendMessage" prefHeight="50.0" prefWidth="65.0" styleClass="btn-icon">
                        <graphic>
                            <ImageView fitHeight="25.0" fitWidth="48.0" preserveRatio="true">
                                <image>
                                    <Image url="@icons/send.png" />
                                </image>
                            </ImageView>
                        </graphic>
                    </Button>
                </HBox>
            </bottom>

        </BorderPane>
    </center>

</BorderPane>
